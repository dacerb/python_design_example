from example_compliance_engine.compliance_engine.chain_handler import ChainHandler


class VulnerabilityCritical(ChainHandler):

    def handler(self,  request):
        try:
            critical_vulnerability = request.get("vulnerabilidades", {}).get("critical", {})
            if len(critical_vulnerability):
                print(f"critical_vulnerability: {len(critical_vulnerability)} is invalid")

        except Exception as e:
            print("problems with critical_vulnerability validation")
            raise e
        finally:
            if self._next_handler: self._next_handler.handler(request)
