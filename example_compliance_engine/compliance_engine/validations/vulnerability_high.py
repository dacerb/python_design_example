from example_compliance_engine.compliance_engine.chain_handler import ChainHandler


class VulnerabilityHigh(ChainHandler):

    def handler(self,  request):
        try:
            high_vulnerability = request.get("vulnerabilidades", {}).get("high", {})
            if len(high_vulnerability):
                print(f"high_vulnerability: {len(high_vulnerability)} is invalid")

        except Exception as e:
            print("problems with high_vulnerability validation")
            raise e
        finally:
            if self._next_handler: self._next_handler.handler(request)
