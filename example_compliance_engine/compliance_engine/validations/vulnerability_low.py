from example_compliance_engine.compliance_engine.chain_handler import ChainHandler


class VulnerabilityLow(ChainHandler):

    def handler(self,  request):
        try:
            low_vulnerability = request.get("vulnerabilidades", {}).get("low", {})
            if len(low_vulnerability):
                print(f"low_vulnerability: {len(low_vulnerability)} is invalid")

        except Exception as e:
            print("problems with low_vulnerability validation")
            raise e
        finally:
            if self._next_handler: self._next_handler.handler(request)
